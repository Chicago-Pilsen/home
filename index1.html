<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TireInspector Pro | Professional Tire Analysis System</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            width: 100%;
            height: 100%;
            overflow-x: hidden;
            position: fixed;
        }

        .hidden-file-input {
            display: none;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f1419 0%, #1a202c 50%, #2d3748 100%);
            color: #ffffff;
            height: 100vh;
            overflow-y: auto;
            overflow-x: hidden;
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .container {
            max-width: 100vw;
            width: 100%;
            height: 100vh;
            margin: 0;
            background: rgba(15, 20, 25, 0.95);
            backdrop-filter: blur(20px);
            padding: 24px;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .header {
            text-align: center;
            margin-bottom: 32px;
            padding: 24px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .logo {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 50%, #2b77cb 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
            letter-spacing: -0.02em;
        }

        .tagline {
            font-size: 0.875rem;
            color: #a0aec0;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 32px;
            margin-bottom: 32px;
        }

        .card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 24px;
            backdrop-filter: blur(10px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .card-icon {
            width: 24px;
            height: 24px;
            margin-right: 12px;
            color: #4299e1;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #ffffff;
            letter-spacing: -0.01em;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #e2e8f0;
            font-size: 0.875rem;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.05);
            color: #ffffff;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
            background: rgba(255, 255, 255, 0.08);
        }

        .form-input::placeholder {
            color: #718096;
        }

        .plate-lookup-group {
            display: flex;
            gap: 12px;
            align-items: end;
        }

        .plate-input-wrapper {
            flex: 1;
        }

        .lookup-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            color: white;
            font-weight: 600;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .lookup-btn:hover {
            background: linear-gradient(135deg, #63b3ed 0%, #4299e1 100%);
            transform: translateY(-1px);
        }

        .lookup-btn:disabled {
            background: #4a5568;
            cursor: not-allowed;
            transform: none;
        }

        .lookup-status {
            margin-top: 8px;
            font-size: 0.75rem;
            padding: 8px 12px;
            border-radius: 6px;
            font-weight: 500;
        }

        .lookup-success {
            background: rgba(56, 161, 105, 0.2);
            color: #68d391;
            border: 1px solid rgba(56, 161, 105, 0.3);
        }

        .lookup-error {
            background: rgba(229, 62, 62, 0.2);
            color: #fc8181;
            border: 1px solid rgba(229, 62, 62, 0.3);
        }

        .lookup-info {
            background: rgba(66, 153, 225, 0.2);
            color: #90cdf4;
            border: 1px solid rgba(66, 153, 225, 0.3);
        }

        .vehicle-info-display {
            margin-top: 16px;
            padding: 16px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: none;
        }

        .vehicle-detail {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.875rem;
        }

        .vehicle-detail:last-child {
            margin-bottom: 0;
        }

        .vehicle-detail-label {
            color: #a0aec0;
            font-weight: 500;
        }

        .vehicle-detail-value {
            color: #e2e8f0;
            font-weight: 600;
        }

        .tire-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .tire-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 20px;
            min-height: 320px;
            transition: all 0.3s ease;
        }

        .tire-card:hover {
            border-color: rgba(66, 153, 225, 0.3);
            background: rgba(255, 255, 255, 0.05);
        }

        .tire-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #4299e1;
            text-align: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .measurements-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 16px;
        }

        .measurement-input {
            text-align: center;
        }

        .measurement-label {
            font-size: 0.75rem;
            font-weight: 500;
            color: #a0aec0;
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .measurement-field {
            width: 100%;
            padding: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.05);
            color: #ffffff;
            font-size: 0.875rem;
            font-weight: 600;
            text-align: center;
            transition: all 0.2s ease;
        }

        .measurement-field:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 2px rgba(66, 153, 225, 0.1);
        }

        .action-buttons {
            display: flex;
            gap: 8px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 16px;
        }

        .action-btn {
            flex: 1;
            min-width: 80px;
            padding: 10px 12px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
        }

        .dry-rot-btn {
            background: linear-gradient(135deg, #e53e3e 0%, #c53030 100%);
            color: white;
            box-shadow: 0 4px 6px rgba(229, 62, 62, 0.2);
        }

        .dry-rot-btn:hover {
            background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
            transform: translateY(-1px);
            box-shadow: 0 6px 10px rgba(229, 62, 62, 0.3);
        }

        .dry-rot-btn.active {
            background: linear-gradient(135deg, #fc8181 0%, #f56565 100%);
            box-shadow: 0 0 20px rgba(229, 62, 62, 0.4);
        }

        .bubble-btn {
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            color: white;
            box-shadow: 0 4px 6px rgba(66, 153, 225, 0.2);
        }

        .bubble-btn:hover {
            background: linear-gradient(135deg, #63b3ed 0%, #4299e1 100%);
            transform: translateY(-1px);
            box-shadow: 0 6px 10px rgba(66, 153, 225, 0.3);
        }

        .bubble-btn.active {
            background: linear-gradient(135deg, #90cdf4 0%, #63b3ed 100%);
            box-shadow: 0 0 20px rgba(66, 153, 225, 0.4);
        }

        .camera-btn {
            background: linear-gradient(135deg, #718096 0%, #4a5568 100%);
            color: white;
            box-shadow: 0 4px 6px rgba(113, 128, 150, 0.2);
        }

        .camera-btn:hover {
            background: linear-gradient(135deg, #a0aec0 0%, #718096 100%);
            transform: translateY(-1px);
            box-shadow: 0 6px 10px rgba(113, 128, 150, 0.3);
        }

        .camera-btn.active {
            background: linear-gradient(135deg, #38b2ac 0%, #319795 100%);
            box-shadow: 0 0 20px rgba(56, 178, 172, 0.4);
        }

        .photo-preview {
            margin-top: 12px;
            text-align: center;
        }

        .photo-preview img {
            max-width: 80px;
            max-height: 60px;
            border-radius: 6px;
            border: 2px solid #4299e1;
            object-fit: cover;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .photo-preview img:hover {
            transform: scale(1.1);
            border-color: #63b3ed;
            box-shadow: 0 4px 12px rgba(66, 153, 225, 0.3);
        }

        .photo-info {
            font-size: 0.625rem;
            color: #a0aec0;
            margin-top: 4px;
            font-weight: 500;
        }

        .photo-fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            cursor: pointer;
            backdrop-filter: blur(10px);
        }

        .photo-fullscreen img {
            max-width: 95vw;
            max-height: 95vh;
            object-fit: contain;
            border: 3px solid #4299e1;
            border-radius: 12px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
        }

        .control-buttons {
            display: flex;
            gap: 16px;
            margin-bottom: 32px;
        }

        .primary-btn {
            flex: 1;
            padding: 16px 24px;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .inspect-btn {
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            color: white;
            box-shadow: 0 10px 15px rgba(66, 153, 225, 0.3);
        }

        .inspect-btn:hover {
            background: linear-gradient(135deg, #63b3ed 0%, #4299e1 100%);
            transform: translateY(-2px);
            box-shadow: 0 15px 25px rgba(66, 153, 225, 0.4);
        }

        .print-btn {
            background: linear-gradient(135deg, #38a169 0%, #2f855a 100%);
            color: white;
            box-shadow: 0 10px 15px rgba(56, 161, 105, 0.3);
            display: none;
        }

        .print-btn:hover {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            transform: translateY(-2px);
            box-shadow: 0 15px 25px rgba(56, 161, 105, 0.4);
        }

        .results {
            margin-top: 32px;
            display: none;
        }

        .results-header {
            display: flex;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .results-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #ffffff;
            letter-spacing: -0.01em;
        }

        .tire-result {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
        }

        .tire-result-header {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 12px;
            color: #4299e1;
        }

        .measurement-results {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 12px;
        }

        .measurement-result {
            padding: 8px 12px;
            border-radius: 6px;
            text-align: center;
            font-weight: 600;
            font-size: 0.875rem;
        }

        .measurement-result.good {
            background: linear-gradient(135deg, #38a169 0%, #2f855a 100%);
            color: white;
        }

        .measurement-result.ok {
            background: linear-gradient(135deg, #d69e2e 0%, #b7791f 100%);
            color: white;
        }

        .measurement-result.bad {
            background: linear-gradient(135deg, #e53e3e 0%, #c53030 100%);
            color: white;
        }

        .tire-status {
            text-align: center;
            padding: 12px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .tire-status.good {
            background: linear-gradient(135deg, #38a169 0%, #2f855a 100%);
            color: white;
        }

        .tire-status.ok {
            background: linear-gradient(135deg, #d69e2e 0%, #b7791f 100%);
            color: white;
        }

        .tire-status.bad {
            background: linear-gradient(135deg, #e53e3e 0%, #c53030 100%);
            color: white;
        }

        .alignment-warning {
            background: linear-gradient(135deg, #dd6b20 0%, #c05621 100%);
            color: white;
            padding: 12px;
            border-radius: 8px;
            margin-top: 12px;
            text-align: center;
            font-weight: 600;
            font-size: 0.875rem;
        }

        .alignment-critical {
            background: linear-gradient(135deg, #e53e3e 0%, #c53030 100%);
            color: white;
            padding: 14px;
            border-radius: 8px;
            margin-top: 12px;
            text-align: center;
            font-weight: 600;
            border: 2px solid #fc8181;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(229, 62, 62, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(229, 62, 62, 0); }
            100% { box-shadow: 0 0 0 0 rgba(229, 62, 62, 0); }
        }

        .overall-recommendation {
            margin-top: 24px;
            padding: 24px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 1.125rem;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .recommendation-good {
            background: linear-gradient(135deg, #38a169 0%, #2f855a 100%);
            color: white;
        }

        .recommendation-suggest {
            background: linear-gradient(135deg, #d69e2e 0%, #b7791f 100%);
            color: white;
        }

        .recommendation-replace {
            background: linear-gradient(135deg, #e53e3e 0%, #c53030 100%);
            color: white;
        }

        .maintenance-alert {
            margin-top: 16px;
            padding: 16px;
            border-radius: 8px;
            border-left: 4px solid #4299e1;
            background: rgba(66, 153, 225, 0.1);
            backdrop-filter: blur(5px);
        }

        .maintenance-alert h4 {
            color: #4299e1;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .maintenance-list {
            margin: 0;
            padding-left: 20px;
        }

        .maintenance-list li {
            color: #e2e8f0;
            font-size: 0.875rem;
            margin-bottom: 4px;
            line-height: 1.4;
        }

        .maintenance-urgent {
            border-left-color: #e53e3e;
            background: rgba(229, 62, 62, 0.1);
        }

        .maintenance-urgent h4 {
            color: #e53e3e;
        }

        .maintenance-warning {
            border-left-color: #d69e2e;
            background: rgba(214, 158, 46, 0.1);
        }

        .maintenance-warning h4 {
            color: #d69e2e;
        }

        @media print {
            body {
                background: white;
                color: black;
            }
            
            .container {
                background: white;
                border: 2px solid #000;
                color: black;
                box-shadow: none;
            }
            
            .control-buttons {
                display: none;
            }
            
            .card {
                background: #f5f5f5;
                border: 1px solid #000;
            }
            
            .results {
                background: #f5f5f5;
                border: 2px solid #000;
            }
        }

        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
                gap: 24px;
            }
            
            .tire-grid {
                grid-template-columns: 1fr;
            }
            
            .control-buttons {
                flex-direction: column;
            }
            
            .logo {
                font-size: 2rem;
            }

            .container {
                padding: 16px;
            }

            .plate-lookup-group {
                flex-direction: column;
                gap: 8px;
            }

            .lookup-btn {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">TireInspector Pro</div>
            <div class="tagline">Professional Tire Analysis System</div>
        </div>

        <div class="main-grid">
            <div class="card">
                <div class="card-header">
                    <svg class="card-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    <h2 class="card-title">Vehicle Information</h2>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="plateNumber">License Plate Number</label>
                    <div class="plate-lookup-group">
                        <div class="plate-input-wrapper">
                            <input type="text" id="plateNumber" class="form-input" placeholder="e.g., ABC1234" style="text-transform: uppercase;">
                        </div>
                        <button type="button" class="lookup-btn" id="lookupBtn" onclick="lookupVehicle()">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                            </svg>
                            Lookup
                        </button>
                    </div>
                    <div id="lookupStatus" class="lookup-status" style="display: none;"></div>
                </div>

                <div id="vehicleInfoDisplay" class="vehicle-info-display">
                    <div class="vehicle-detail">
                        <span class="vehicle-detail-label">Year:</span>
                        <span class="vehicle-detail-value" id="vehicleYear">-</span>
                    </div>
                    <div class="vehicle-detail">
                        <span class="vehicle-detail-label">Make:</span>
                        <span class="vehicle-detail-value" id="vehicleMake">-</span>
                    </div>
                    <div class="vehicle-detail">
                        <span class="vehicle-detail-label">Model:</span>
                        <span class="vehicle-detail-value" id="vehicleModel">-</span>
                    </div>
                    <div class="vehicle-detail">
                        <span class="vehicle-detail-label">Engine:</span>
                        <span class="vehicle-detail-value" id="vehicleEngine">-</span>
                    </div>
                    <div class="vehicle-detail">
                        <span class="vehicle-detail-label">Drivetrain:</span>
                        <span class="vehicle-detail-value" id="vehicleDrivetrain">-</span>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label" for="dotDate">DOT Manufacturing Date</label>
                    <input type="text" id="dotDate" class="form-input" placeholder="e.g., 2823 (week 28 of 2023)">
                </div>
                <div class="form-group">
                    <label class="form-label" for="vehicleMileage">Current Vehicle Mileage</label>
                    <input type="number" id="vehicleMileage" class="form-input" placeholder="Enter current mileage" min="0">
                </div>
                <div class="form-group">
                    <label class="form-label" for="driveType">Drivetrain Configuration</label>
                    <select id="driveType" class="form-select">
                        <option value="fwd">Front-Wheel Drive (FWD)</option>
                        <option value="rwd">Rear-Wheel Drive (RWD)</option>
                        <option value="awd">All-Wheel Drive (AWD)</option>
                        <option value="4wd">Four-Wheel Drive (4WD)</option>
                    </select>
                </div>
                <div id="maintenanceAlert" class="maintenance-alert" style="display: none;"></div>
            </div>

            <div class="card">
                <div class="card-header">
                    <svg class="card-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                    </svg>
                    <h2 class="card-title">Tread Depth Measurements</h2>
                </div>
                <div class="tire-grid">
                    <div class="tire-card">
                        <h3 class="tire-title">Front Left</h3>
                        <div class="measurements-grid">
                            <div class="measurement-input">
                                <div class="measurement-label">Inner</div>
                                <input type="number" id="fl_left" class="measurement-field" placeholder="32nds" min="1" max="12">
                            </div>
                            <div class="measurement-input">
                                <div class="measurement-label">Center</div>
                                <input type="number" id="fl_crown" class="measurement-field" placeholder="32nds" min="1" max="12">
                            </div>
                            <div class="measurement-input">
                                <div class="measurement-label">Outer</div>
                                <input type="number" id="fl_right" class="measurement-field" placeholder="32nds" min="1" max="12">
                            </div>
                        </div>
                        <div class="action-buttons">
                            <button type="button" class="action-btn dry-rot-btn" id="fl_dryrot" onclick="toggleDryRot('fl_dryrot')">
                                🔴 Dry Rot
                            </button>
                            <button type="button" class="action-btn bubble-btn" id="fl_bubble" onclick="toggleBubble('fl_bubble')">
                                🫧 Bubble
                            </button>
                            <button type="button" class="action-btn camera-btn" id="fl_camera" onclick="takePhoto('fl')">
                                📷 Photo
                            </button>
                        </div>
                        <input type="file" id="fl_photo_input" class="hidden-file-input" accept="image/*" capture="environment" onchange="handlePhotoUpload('fl', this)">
                        <div id="fl_photo_preview" class="photo-preview"></div>
                    </div>
                    
                    <div class="tire-card">
                        <h3 class="tire-title">Front Right</h3>
                        <div class="measurements-grid">
                            <div class="measurement-input">
                                <div class="measurement-label">Inner</div>
                                <input type="number" id="fr_left" class="measurement-field" placeholder="32nds" min="1" max="12">
                            </div>
                            <div class="measurement-input">
                                <div class="measurement-label">Center</div>
                                <input type="number" id="fr_crown" class="measurement-field" placeholder="32nds" min="1" max="12">
                            </div>
                            <div class="measurement-input">
                                <div class="measurement-label">Outer</div>
                                <input type="number" id="fr_right" class="measurement-field" placeholder="32nds" min="1" max="12">
                            </div>
                        </div>
                        <div class="action-buttons">
                            <button type="button" class="action-btn dry-rot-btn" id="fr_dryrot" onclick="toggleDryRot('fr_dryrot')">
                                🔴 Dry Rot
                            </button>
                            <button type="button" class="action-btn bubble-btn" id="fr_bubble" onclick="toggleBubble('fr_bubble')">
                                🫧 Bubble
                            </button>
                            <button type="button" class="action-btn camera-btn" id="fr_camera" onclick="takePhoto('fr')">
                                📷 Photo
                            </button>
                        </div>
                        <input type="file" id="fr_photo_input" class="hidden-file-input" accept="image/*" capture="environment" onchange="handlePhotoUpload('fr', this)">
                        <div id="fr_photo_preview" class="photo-preview"></div>
                    </div>
                    
                    <div class="tire-card">
                        <h3 class="tire-title">Rear Left</h3>
                        <div class="measurements-grid">
                            <div class="measurement-input">
                                <div class="measurement-label">Inner</div>
                                <input type="number" id="rl_left" class="measurement-field" placeholder="32nds" min="1" max="12">
                            </div>
                            <div class="measurement-input">
                                <div class="measurement-label">Center</div>
                                <input type="number" id="rl_crown" class="measurement-field" placeholder="32nds" min="1" max="12">
                            </div>
                            <div class="measurement-input">
                                <div class="measurement-label">Outer</div>
                                <input type="number" id="rl_right" class="measurement-field" placeholder="32nds" min="1" max="12">
                            </div>
                        </div>
                        <div class="action-buttons">
                            <button type="button" class="action-btn dry-rot-btn" id="rl_dryrot" onclick="toggleDryRot('rl_dryrot')">
                                🔴 Dry Rot
                            </button>
                            <button type="button" class="action-btn bubble-btn" id="rl_bubble" onclick="toggleBubble('rl_bubble')">
                                🫧 Bubble
                            </button>
                            <button type="button" class="action-btn camera-btn" id="rl_camera" onclick="takePhoto('rl')">
                                📷 Photo
                            </button>
                        </div>
                        <input type="file" id="rl_photo_input" class="hidden-file-input" accept="image/*" capture="environment" onchange="handlePhotoUpload('rl', this)">
                        <div id="rl_photo_preview" class="photo-preview"></div>
                    </div>
                    
                    <div class="tire-card">
                        <h3 class="tire-title">Rear Right</h3>
                        <div class="measurements-grid">
                            <div class="measurement-input">
                                <div class="measurement-label">Inner</div>
                                <input type="number" id="rr_left" class="measurement-field" placeholder="32nds" min="1" max="12">
                            </div>
                            <div class="measurement-input">
                                <div class="measurement-label">Center</div>
                                <input type="number" id="rr_crown" class="measurement-field" placeholder="32nds" min="1" max="12">
                            </div>
                            <div class="measurement-input">
                                <div class="measurement-label">Outer</div>
                                <input type="number" id="rr_right" class="measurement-field" placeholder="32nds" min="1" max="12">
                            </div>
                        </div>
                        <div class="action-buttons">
                            <button type="button" class="action-btn dry-rot-btn" id="rr_dryrot" onclick="toggleDryRot('rr_dryrot')">
                                🔴 Dry Rot
                            </button>
                            <button type="button" class="action-btn bubble-btn" id="rr_bubble" onclick="toggleBubble('rr_bubble')">
                                🫧 Bubble
                            </button>
                            <button type="button" class="action-btn camera-btn" id="rr_camera" onclick="takePhoto('rr')">
                                📷 Photo
                            </button>
                        </div>
                        <input type="file" id="rr_photo_input" class="hidden-file-input" accept="image/*" capture="environment" onchange="handlePhotoUpload('rr', this)">
                        <div id="rr_photo_preview" class="photo-preview"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="control-buttons">
            <button class="primary-btn inspect-btn" onclick="inspectTires()">
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                </svg>
                Analyze Tires
            </button>
            <button class="primary-btn print-btn" id="printBtn" onclick="printResults()">
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"></path>
                </svg>
                Print Report
            </button>
        </div>

        <div id="results" class="results card">
            <div class="results-header">
                <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <h2 class="results-title">Inspection Results</h2>
            </div>
            <div id="tireResults"></div>
            <div id="overallRecommendation" class="overall-recommendation"></div>
        </div>
    </div>

    <script>
        // Vehicle lookup functionality
        async function lookupVehicle() {
            const plateNumber = document.getElementById('plateNumber').value.trim().toUpperCase();
            const lookupBtn = document.getElementById('lookupBtn');
            const lookupStatus = document.getElementById('lookupStatus');
            const vehicleDisplay = document.getElementById('vehicleInfoDisplay');

            if (!plateNumber) {
                showLookupStatus('Please enter a license plate number', 'error');
                return;
            }

            // Validate plate format (basic US format)
            const plateRegex = /^[A-Z0-9]{2,8}$/;
            if (!plateRegex.test(plateNumber)) {
                showLookupStatus('Invalid plate format', 'error');
                return;
            }

            lookupBtn.disabled = true;
            lookupBtn.innerHTML = '<svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><polyline points="8,12 12,16 16,12"></polyline></svg> Looking up...';
            
            try {
                // This is a mock lookup - in real implementation, you'd call a vehicle data API
                // Popular APIs include: NHTSA VIN API, Carfax, AutoCheck, etc.
                const vehicleData = await mockVehicleLookup(plateNumber);
                
                if (vehicleData) {
                    displayVehicleInfo(vehicleData);
                    showLookupStatus(`✅ Vehicle found: ${vehicleData.year} ${vehicleData.make} ${vehicleData.model}`, 'success');
                    
                    // Auto-populate drivetrain if available
                    if (vehicleData.drivetrain) {
                        const driveTypeSelect = document.getElementById('driveType');
                        const driveTypeMap = {
                            'FWD': 'fwd',
                            'RWD': 'rwd', 
                            'AWD': 'awd',
                            '4WD': '4wd'
                        };
                        
                        const mappedType = driveTypeMap[vehicleData.drivetrain];
                        if (mappedType) {
                            driveTypeSelect.value = mappedType;
                        }
                    }
                } else {
                    showLookupStatus('❌ Vehicle not found in database', 'error');
                }
            } catch (error) {
                console.error('Lookup error:', error);
                showLookupStatus('⚠️ Lookup service unavailable - please enter manually', 'info');
            } finally {
                lookupBtn.disabled = false;
                lookupBtn.innerHTML = '<svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg> Lookup';
            }
        }

        function showLookupStatus(message, type) {
            const lookupStatus = document.getElementById('lookupStatus');
            lookupStatus.textContent = message;
            lookupStatus.className = `lookup-status lookup-${type}`;
            lookupStatus.style.display = 'block';
            
            // Auto-hide success messages after 5 seconds
            if (type === 'success') {
                setTimeout(() => {
                    lookupStatus.style.display = 'none';
                }, 5000);
            }
        }

        function displayVehicleInfo(vehicleData) {
            document.getElementById('vehicleYear').textContent = vehicleData.year || '-';
            document.getElementById('vehicleMake').textContent = vehicleData.make || '-';
            document.getElementById('vehicleModel').textContent = vehicleData.model || '-';
            document.getElementById('vehicleEngine').textContent = vehicleData.engine || '-';
            document.getElementById('vehicleDrivetrain').textContent = vehicleData.drivetrain || '-';
            
            document.getElementById('vehicleInfoDisplay').style.display = 'block';
        }

        // Mock vehicle lookup function - replace with real API call
        async function mockVehicleLookup(plateNumber) {
            // Simulate API delay
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            // Mock database of vehicles (in real app, this would be an API call)
            const mockDatabase = {
                'ABC1234': {
                    year: '2022',
                    make: 'Toyota',
                    model: 'Camry',
                    engine: '2.5L 4-Cyl',
                    drivetrain: 'FWD'
                },
                'XYZ5678': {
                    year: '2021',
                    make: 'Ford',
                    model: 'F-150',
                    engine: '3.5L V6 EcoBoost',
                    drivetrain: '4WD'
                },
                'DEF9012': {
                    year: '2023',
                    make: 'Subaru',
                    model: 'Outback',
                    engine: '2.5L 4-Cyl',
                    drivetrain: 'AWD'
                },
                'GHI3456': {
                    year: '2020',
                    make: 'BMW',
                    model: '3 Series',
                    engine: '2.0L 4-Cyl Turbo',
                    drivetrain: 'RWD'
                }
            };
            
            return mockDatabase[plateNumber] || null;
        }

        // Auto-format plate number as user types
        document.getElementById('plateNumber').addEventListener('input', function(e) {
            this.value = this.value.toUpperCase().replace(/[^A-Z0-9]/g, '');
        });

        // Allow Enter key to trigger lookup
        document.getElementById('plateNumber').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                lookupVehicle();
            }
        });

        function calculateTireAge(dotDate) {
            if (!dotDate || dotDate.length !== 4) return null;
            
            const week = parseInt(dotDate.substring(0, 2));
            const year = parseInt(dotDate.substring(2, 4));
            
            // Convert 2-digit year to 4-digit year
            const fullYear = year < 50 ? 2000 + year : 1900 + year;
            
            const currentYear = new Date().getFullYear();
            const ageInYears = currentYear - fullYear;
            
            return ageInYears;
        }

        function analyzeMaintenanceNeeds(mileage) {
            if (!mileage || mileage < 0) return null;
            
            const maintenanceSchedule = {
                immediate: [],
                upcoming: [],
                replace: []
            };
            
            // Oil change intervals (every 5,000-7,500 miles)
            const nextOilChange = Math.ceil(mileage / 5000) * 5000;
            if (mileage % 5000 > 4000 || mileage % 5000 === 0) {
                maintenanceSchedule.immediate.push("Oil change and filter replacement");
            } else if (mileage % 5000 > 3000) {
                maintenanceSchedule.upcoming.push(`Oil change due at ${nextOilChange} miles`);
            }
            
            // Tire rotation (every 6,000-8,000 miles)
            if (mileage % 6000 > 5000 || mileage % 6000 === 0) {
                maintenanceSchedule.immediate.push("Tire rotation service");
            }
            
            // Air filter (every 15,000-30,000 miles)
            if (mileage % 15000 === 0 || (mileage % 15000 > 13000)) {
                maintenanceSchedule.immediate.push("Air filter inspection/replacement");
            }
            
            // Brake inspection (every 15,000 miles)
            if (mileage >= 15000 && mileage % 15000 < 1000) {
                maintenanceSchedule.immediate.push("Brake system inspection");
            }
            
            // Major service intervals
            if (mileage >= 30000) {
                const interval30k = Math.floor(mileage / 30000);
                if (mileage % 30000 < 1000) {
                    maintenanceSchedule.immediate.push("30K mile major service interval");
                    maintenanceSchedule.immediate.push("Transmission fluid check");
                    maintenanceSchedule.immediate.push("Coolant system inspection");
                }
            }
            
            // 60K mile services
            if (mileage >= 60000 && mileage % 60000 < 1000) {
                maintenanceSchedule.replace.push("Spark plugs replacement");
                maintenanceSchedule.replace.push("Transmission fluid replacement");
                maintenanceSchedule.immediate.push("Belt and hose inspection");
            }
            
            // 90K mile services  
            if (mileage >= 90000 && mileage % 90000 < 1000) {
                maintenanceSchedule.replace.push("Timing belt replacement (if equipped)");
                maintenanceSchedule.replace.push("Water pump inspection");
                maintenanceSchedule.immediate.push("Coolant system flush");
            }
            
            // High mileage considerations
            if (mileage >= 100000) {
                maintenanceSchedule.upcoming.push("Consider high-mileage oil");
                if (mileage % 100000 < 5000) {
                    maintenanceSchedule.replace.push("Suspension components inspection");
                    maintenanceSchedule.replace.push("Brake fluid replacement");
                }
            }
            
            // Fuel filter (every 30,000-40,000 miles)
            if (mileage >= 30000 && mileage % 40000 < 2000) {
                maintenanceSchedule.immediate.push("Fuel filter replacement");
            }
            
            return maintenanceSchedule;
        }

        function displayMaintenanceAlert(mileage) {
            const alertDiv = document.getElementById('maintenanceAlert');
            const schedule = analyzeMaintenanceNeeds(mileage);
            
            if (!schedule || (schedule.immediate.length === 0 && schedule.upcoming.length === 0 && schedule.replace.length === 0)) {
                alertDiv.style.display = 'none';
                return;
            }
            
            let alertClass = 'maintenance-alert';
            let alertTitle = '🔧 Maintenance Recommendations';
            let alertIcon = '🔧';
            
            if (schedule.immediate.length > 0 || schedule.replace.length > 0) {
                alertClass += ' maintenance-urgent';
                alertTitle = '⚠️ Service Required';
                alertIcon = '⚠️';
            } else if (schedule.upcoming.length > 0) {
                alertClass += ' maintenance-warning';
                alertTitle = '📅 Upcoming Service';
                alertIcon = '📅';
            }
            
            let alertContent = `<h4>${alertIcon} ${alertTitle}</h4>`;
            
            if (schedule.immediate.length > 0) {
                alertContent += '<ul class="maintenance-list">';
                schedule.immediate.forEach(item => {
                    alertContent += `<li><strong>Service Now:</strong> ${item}</li>`;
                });
                alertContent += '</ul>';
            }
            
            if (schedule.replace.length > 0) {
                alertContent += '<ul class="maintenance-list">';
                schedule.replace.forEach(item => {
                    alertContent += `<li><strong>Replace:</strong> ${item}</li>`;
                });
                alertContent += '</ul>';
            }
            
            if (schedule.upcoming.length > 0) {
                alertContent += '<ul class="maintenance-list">';
                schedule.upcoming.forEach(item => {
                    alertContent += `<li><strong>Upcoming:</strong> ${item}</li>`;
                });
                alertContent += '</ul>';
            }
            
            alertDiv.className = alertClass;
            alertDiv.innerHTML = alertContent;
            alertDiv.style.display = 'block';
        }

        // Auto-detect maintenance needs when mileage changes
        document.addEventListener('DOMContentLoaded', function() {
            const mileageInput = document.getElementById('vehicleMileage');
            if (mileageInput) {
                mileageInput.addEventListener('input', function() {
                    const mileage = parseInt(this.value);
                    if (mileage && mileage > 0) {
                        displayMaintenanceAlert(mileage);
                    } else {
                        const alertDiv = document.getElementById('maintenanceAlert');
                        if (alertDiv) {
                            alertDiv.style.display = 'none';
                        }
                    }
                });
            }
        });

        function getTireCondition(treadDepth) {
            if (treadDepth >= 7) return 'good';
            if (treadDepth >= 4) return 'ok';
            return 'bad';
        }

        function toggleDryRot(buttonId) {
            const button = document.getElementById(buttonId);
            button.classList.toggle('active');
            
            if (button.classList.contains('active')) {
                button.innerHTML = '🔴 <span>Detected</span>';
            } else {
                button.innerHTML = '🔴 <span>Dry Rot</span>';
            }
        }

        function toggleBubble(buttonId) {
            const button = document.getElementById(buttonId);
            button.classList.toggle('active');
            
            if (button.classList.contains('active')) {
                button.innerHTML = '🫧 <span>Detected</span>';
            } else {
                button.innerHTML = '🫧 <span>Bubble</span>';
            }
        }

        function takePhoto(tireId) {
            const fileInput = document.getElementById(tireId + '_photo_input');
            fileInput.click();
        }

        function handlePhotoUpload(tireId, input) {
            const file = input.files[0];
            if (!file) return;
            
            // Check file size (limit to 3MB per tire)
            if (file.size > 3 * 1024 * 1024) {
                alert('Photo size too large. Please choose a photo under 3MB.');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    // Resize image to optimal size (max 600x400 for smaller files)
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    
                    const maxWidth = 600;
                    const maxHeight = 400;
                    let { width, height } = img;
                    
                    // Calculate new dimensions
                    if (width > height) {
                        if (width > maxWidth) {
                            height = (height * maxWidth) / width;
                            width = maxWidth;
                        }
                    } else {
                        if (height > maxHeight) {
                            width = (width * maxHeight) / height;
                            height = maxHeight;
                        }
                    }
                    
                    canvas.width = width;
                    canvas.height = height;
                    
                    // Draw and compress more for smaller file size
                    ctx.drawImage(img, 0, 0, width, height);
                    const compressedDataUrl = canvas.toDataURL('image/jpeg', 0.7);
                    
                    // Display preview
                    displayPhotoPreview(tireId, compressedDataUrl, file.name);
                    
                    // Activate camera button
                    const cameraBtn = document.getElementById(tireId + '_camera');
                    cameraBtn.classList.add('active');
                    cameraBtn.innerHTML = '📷 <span>Captured</span>';
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function displayPhotoPreview(tireId, dataUrl, fileName) {
            const previewDiv = document.getElementById(tireId + '_photo_preview');
            previewDiv.innerHTML = `
                <img src="${dataUrl}" alt="Tire damage photo" onclick="toggleFullscreen('${tireId}', '${dataUrl}')">
                <div class="photo-info">${fileName}</div>
            `;
        }

        function toggleFullscreen(tireId, dataUrl) {
            const existingFullscreen = document.querySelector('.photo-fullscreen');
            
            if (existingFullscreen) {
                // Remove fullscreen if it exists
                existingFullscreen.remove();
            } else {
                // Create fullscreen overlay
                const fullscreenDiv = document.createElement('div');
                fullscreenDiv.className = 'photo-fullscreen';
                fullscreenDiv.onclick = () => fullscreenDiv.remove();
                
                const fullscreenImg = document.createElement('img');
                fullscreenImg.src = dataUrl;
                fullscreenImg.alt = `${tireId} tire damage photo`;
                
                fullscreenDiv.appendChild(fullscreenImg);
                document.body.appendChild(fullscreenDiv);
            }
        }

        function checkAlignment(measurements, tireName) {
            const diff1 = Math.abs(measurements.left - measurements.crown);
            const diff2 = Math.abs(measurements.crown - measurements.right);
            const diff3 = Math.abs(measurements.left - measurements.right);
            
            // Check for exactly 1/32" or 2/32" differences
            const has1Diff = (diff1 === 1 || diff2 === 1 || diff3 === 1);
            const has2Diff = (diff1 === 2 || diff2 === 2 || diff3 === 2);
            const hasOver2Diff = (diff1 > 2 || diff2 > 2 || diff3 > 2);
            
            let alignmentIssue = '';
            let isHighlyRecommended = false;
            
            // Determine specific wear pattern and recommendation level
            if (measurements.left < measurements.crown && measurements.left < measurements.right) {
                if (has2Diff || hasOver2Diff) {
                    alignmentIssue = 'Inner edge wear detected - HIGHLY RECOMMEND ALIGNMENT';
                    isHighlyRecommended = true;
                } else if (has1Diff) {
                    alignmentIssue = 'Inner edge wear detected - Recommend alignment';
                }
            } else if (measurements.right < measurements.crown && measurements.right < measurements.left) {
                if (has2Diff || hasOver2Diff) {
                    alignmentIssue = 'Outer edge wear detected - HIGHLY RECOMMEND ALIGNMENT';
                    isHighlyRecommended = true;
                } else if (has1Diff) {
                    alignmentIssue = 'Outer edge wear detected - Recommend alignment';
                }
            } else if (measurements.crown < measurements.left && measurements.crown < measurements.right) {
                if (has2Diff || hasOver2Diff) {
                    alignmentIssue = 'Center wear detected - Check tire pressure and HIGHLY RECOMMEND ALIGNMENT';
                    isHighlyRecommended = true;
                } else if (has1Diff) {
                    alignmentIssue = 'Center wear detected - Check tire pressure and recommend alignment';
                }
            } else if (has2Diff || hasOver2Diff) {
                alignmentIssue = 'Measurements off by 2+ /32" - HIGHLY RECOMMEND ALIGNMENT';
                isHighlyRecommended = true;
            } else if (has1Diff) {
                alignmentIssue = 'Measurements off by 1/32" - Recommend alignment';
            }
            
            return {
                overall: has1Diff || has2Diff || hasOver2Diff,
                issue: alignmentIssue,
                highlyRecommend: isHighlyRecommended
            };
        }

        function printResults() {
            window.print();
        }

        function inspectTires() {
            const dotDate = document.getElementById('dotDate').value;
            const driveType = document.getElementById('driveType').value;
            
            const tires = {
                frontLeft: {
                    left: parseInt(document.getElementById('fl_left').value),
                    crown: parseInt(document.getElementById('fl_crown').value),
                    right: parseInt(document.getElementById('fl_right').value),
                    dryRot: document.getElementById('fl_dryrot').classList.contains('active'),
                    bubble: document.getElementById('fl_bubble').classList.contains('active'),
                    hasPhoto: document.getElementById('fl_camera').classList.contains('active')
                },
                frontRight: {
                    left: parseInt(document.getElementById('fr_left').value),
                    crown: parseInt(document.getElementById('fr_crown').value),
                    right: parseInt(document.getElementById('fr_right').value),
                    dryRot: document.getElementById('fr_dryrot').classList.contains('active'),
                    bubble: document.getElementById('fr_bubble').classList.contains('active'),
                    hasPhoto: document.getElementById('fr_camera').classList.contains('active')
                },
                rearLeft: {
                    left: parseInt(document.getElementById('rl_left').value),
                    crown: parseInt(document.getElementById('rl_crown').value),
                    right: parseInt(document.getElementById('rl_right').value),
                    dryRot: document.getElementById('rl_dryrot').classList.contains('active'),
                    bubble: document.getElementById('rl_bubble').classList.contains('active'),
                    hasPhoto: document.getElementById('rl_camera').classList.contains('active')
                },
                rearRight: {
                    left: parseInt(document.getElementById('rr_left').value),
                    crown: parseInt(document.getElementById('rr_crown').value),
                    right: parseInt(document.getElementById('rr_right').value),
                    dryRot: document.getElementById('rr_dryrot').classList.contains('active'),
                    bubble: document.getElementById('rr_bubble').classList.contains('active'),
                    hasPhoto: document.getElementById('rr_camera').classList.contains('active')
                }
            };

            // Validate inputs
            let allValid = true;
            Object.values(tires).forEach(tire => {
                if (isNaN(tire.left) || isNaN(tire.crown) || isNaN(tire.right) ||
                    tire.left < 1 || tire.crown < 1 || tire.right < 1) {
                    allValid = false;
                }
            });

            if (!dotDate || !allValid) {
                alert('Please fill in all fields with valid measurements!');
                return;
            }

            const tireAge = calculateTireAge(dotDate);
            const resultsDiv = document.getElementById('results');
            const tireResultsDiv = document.getElementById('tireResults');
            const recommendationDiv = document.getElementById('overallRecommendation');

            // Clear previous results
            tireResultsDiv.innerHTML = '';

            const tireNames = ['Front Left', 'Front Right', 'Rear Left', 'Rear Right'];
            const tireKeys = ['frontLeft', 'frontRight', 'rearLeft', 'rearRight'];
            
            let overallConditions = [];
            let badTireCount = 0;
            let dryRotCount = 0;
            let bubbleCount = 0;
            let alignmentIssues = false;
            let criticalAlignmentNeeded = false;
            
            // Display individual tire results
            tireKeys.forEach((key, index) => {
                const tire = tires[key];
                const minDepth = Math.min(tire.left, tire.crown, tire.right);
                let condition = getTireCondition(minDepth);
                const alignment = checkAlignment(tire, tireNames[index]);
                
                // Manual dry rot detection only - visual inspection required
                const hasDryRot = tire.dryRot;
                const hasBubble = tire.bubble;
                
                // Check for dry rot or bubble - both override tread depth condition
                if (hasDryRot || hasBubble) {
                    condition = 'bad';
                    if (hasDryRot) dryRotCount++;
                    if (hasBubble) bubbleCount++;
                }
                
                overallConditions.push(condition);
                if (condition === 'bad') badTireCount++;
                if (alignment.overall) alignmentIssues = true;
                if (alignment.highlyRecommend) criticalAlignmentNeeded = true;
                
                const tireDiv = document.createElement('div');
                tireDiv.className = 'tire-result';
                
                let statusText = '';
                if (hasDryRot && hasBubble) {
                    statusText = 'DRY ROT & BUBBLE - REPLACE IMMEDIATELY';
                } else if (hasDryRot) {
                    statusText = 'DRY ROT - REPLACE IMMEDIATELY';
                } else if (hasBubble) {
                    statusText = 'BUBBLE DETECTED - REPLACE IMMEDIATELY';
                } else if (condition === 'good') {
                    statusText = 'EXCELLENT CONDITION';
                } else if (condition === 'ok') {
                    statusText = 'MONITOR CLOSELY';
                } else {
                    statusText = 'REPLACEMENT REQUIRED';
                }
                
                // Add photo indicator if photo was taken
                if (tire.hasPhoto) {
                    statusText += ' 📷';
                }
                
                tireDiv.innerHTML = `
                    <h4 class="tire-result-header">${tireNames[index]}</h4>
                    <div class="measurement-results">
                        <div class="measurement-result ${getTireCondition(tire.left)}">
                            Inner: ${tire.left}/32"
                        </div>
                        <div class="measurement-result ${getTireCondition(tire.crown)}">
                            Center: ${tire.crown}/32"
                        </div>
                        <div class="measurement-result ${getTireCondition(tire.right)}">
                            Outer: ${tire.right}/32"
                        </div>
                    </div>
                    <div class="tire-status ${condition}">
                        ${statusText}
                    </div>
                    ${alignment.overall ? `<div class="alignment-warning ${alignment.highlyRecommend ? 'alignment-critical' : ''}">⚠️ ${alignment.issue}</div>` : ''}
                `;
                
                tireResultsDiv.appendChild(tireDiv);
            });

            // Determine overall recommendation
            let recommendation = '';
            let recommendationClass = '';
            
            if (tireAge !== null && tireAge >= 6) {
                recommendation = 'TIRES EXCEED RECOMMENDED AGE - IMMEDIATE REPLACEMENT REQUIRED';
                recommendationClass = 'recommendation-replace';
            } else if (dryRotCount > 0 || bubbleCount > 0) {
                if (driveType === 'awd' || driveType === '4wd') {
                    if (dryRotCount > 0 && bubbleCount > 0) {
                        recommendation = 'CRITICAL DAMAGE DETECTED - REPLACE ALL 4 TIRES (AWD/4WD REQUIREMENT)';
                    } else if (dryRotCount > 0) {
                        recommendation = 'DRY ROT DETECTED - REPLACE ALL 4 TIRES (AWD/4WD REQUIREMENT)';
                    } else {
                        recommendation = 'STRUCTURAL DAMAGE - HIGHLY RECOMMEND ALL 4 TIRES (AWD/4WD)';
                    }
                } else {
                    if (dryRotCount > 0 && bubbleCount > 0) {
                        recommendation = 'MULTIPLE CRITICAL ISSUES - IMMEDIATE TIRE REPLACEMENT';
                    } else if (dryRotCount > 0) {
                        if (dryRotCount === 1) {
                            recommendation = 'DRY ROT DETECTED - IMMEDIATE TIRE REPLACEMENT REQUIRED';
                        } else {
                            recommendation = 'MULTIPLE DRY ROT ISSUES - IMMEDIATE REPLACEMENT REQUIRED';
                        }
                    } else {
                        if (bubbleCount === 1) {
                            recommendation = 'STRUCTURAL DAMAGE - HIGHLY RECOMMEND TIRE REPLACEMENT';
                        } else {
                            recommendation = 'MULTIPLE STRUCTURAL ISSUES - TIRE REPLACEMENT RECOMMENDED';
                        }
                    }
                }
                recommendationClass = 'recommendation-replace';
            } else if (badTireCount > 0) {
                if (driveType === 'awd' || driveType === '4wd') {
                    recommendation = 'REPLACE ALL 4 TIRES (AWD/4WD MATCHING REQUIREMENT)';
                } else if (badTireCount === 1) {
                    recommendation = 'SINGLE TIRE REPLACEMENT REQUIRED';
                } else {
                    recommendation = 'MULTIPLE TIRE REPLACEMENT REQUIRED';
                }
                recommendationClass = 'recommendation-replace';
            } else if (overallConditions.includes('ok')) {
                recommendation = 'SCHEDULE TIRE REPLACEMENT SOON';
                recommendationClass = 'recommendation-suggest';
            } else {
                recommendation = 'ALL TIRES IN EXCELLENT CONDITION';
                recommendationClass = 'recommendation-good';
            }

            // Add age information if available
            if (tireAge !== null) {
                const ageDiv = document.createElement('div');
                ageDiv.className = 'tire-result';
                ageDiv.style.background = tireAge >= 6 ? 'linear-gradient(135deg, #e53e3e 0%, #c53030 100%)' : tireAge >= 4 ? 'linear-gradient(135deg, #d69e2e 0%, #b7791f 100%)' : 'linear-gradient(135deg, #38a169 0%, #2f855a 100%)';
                ageDiv.innerHTML = `
                    <h4 class="tire-result-header">Tire Age Analysis</h4>
                    <div class="tire-status" style="background: transparent; color: white;">
                        Manufacturing Age: ${tireAge} years - ${tireAge >= 6 ? 'EXCEEDS RECOMMENDED AGE' : tireAge >= 4 ? 'APPROACHING AGE LIMIT' : 'WITHIN ACCEPTABLE RANGE'}
                    </div>
                `;
                tireResultsDiv.appendChild(ageDiv);
            }

            // Add alignment warning if needed
            if (alignmentIssues) {
                const alignmentDiv = document.createElement('div');
                alignmentDiv.className = 'tire-result';
                if (criticalAlignmentNeeded) {
                    alignmentDiv.style.background = 'linear-gradient(135deg, #e53e3e 0%, #c53030 100%)';
                    alignmentDiv.innerHTML = `
                        <h4 class="tire-result-header">🚨 CRITICAL ALIGNMENT WARNING</h4>
                        <div class="tire-status" style="background: transparent; color: white;">
                            Severe wear pattern detected - IMMEDIATE ALIGNMENT SERVICE REQUIRED
                        </div>
                    `;
                } else {
                    alignmentDiv.style.background = 'linear-gradient(135deg, #dd6b20 0%, #c05621 100%)';
                    alignmentDiv.innerHTML = `
                        <h4 class="tire-result-header">⚠️ Alignment Service Recommended</h4>
                        <div class="tire-status" style="background: transparent; color: white;">
                            Uneven wear detected - Schedule alignment inspection
                        </div>
                    `;
                }
                tireResultsDiv.appendChild(alignmentDiv);
            }

            recommendationDiv.className = `overall-recommendation ${recommendationClass}`;
            recommendationDiv.textContent = recommendation;

            resultsDiv.style.display = 'block';
            document.getElementById('printBtn').style.display = 'block';
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html>
